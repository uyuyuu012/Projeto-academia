<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Usuários</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./src/output.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body
    class="bg-gradient-to-b from-[#0b1022] to-[#0f172a] text-gray-200 font-sans min-h-screen"
  >
    <header
      class="w-full h-16 bg-[#0f172a] px-5 flex items-center text-white shadow-md sticky top-0 z-50"
    >
      <nav>
        <ul class="flex gap-8 text-lg list-none">
          <li>
            <a
              href="./home.html"
              class="text-white rounded-full text-xl hover:underline underline-offset-4 decoration-4 decoration-[#d3d3d3]"
            >
              Início
            </a>
          </li>
          <li>
            <a
              href="./Usuarios.html"
              class="text-white rounded-full text-xl hover:underline underline-offset-4 decoration-4 decoration-[#d3d3d3]"
            >
              Usuários
            </a>
          </li>
          <li>
            <a
              href="./dashboard.html"
              class="text-white rounded-full text-xl hover:underline underline-offset-4 decoration-4 decoration-[#d3d3d3]"
              >Dashboards
            </a>
          </li>
        </ul>
      </nav>
    </header>

    <main class="p-5 flex items-center gap-4">
      <!-- Gráfico -->
      <div class="flex flex-col items-center space-y-10 w-full">
        <div class="w-96 h-64">
          <canvas id="grafico"></canvas>
        </div>

        <div class="w-96 h-64">
          <canvas id="grafico2"></canvas>
        </div>
        <div class="w-96 h-64">
          <canvas id="grafico3"></canvas>
        </div>
      </div>
      <div class="w-96 h-64"> 
        <canvas id="grafico4"> </canvas>
      </div>
      <!-- Gráfico de colunas na vertical -->
      <script>
        document.addEventListener("DOMContentLoaded", () => {
          const ctx = document.getElementById("grafico").getContext("2d");
          const contagem = getContagemStatus();
          const ativos = contagem.ativo || 0;
          const inativos = contagem.inativo || 0;
          const atrasados = contagem.atraso || 0;

          new Chart(ctx, {
            type: "bar",
            data: {
              labels: ["Clientes"],
              datasets: [
                {
                  label: "Ativos",
                  data: [ativos],
                  backgroundColor: "#16a34a",
                  borderColor: "#16a34a",
                  borderWidth: 1,
                },
                {
                  label: "Inativos",
                  data: [inativos],
                  backgroundColor: "#6b7280",
                  borderColor: "#6b7280",
                  borderWidth: 1,
                },
                {
                  label: "Em Atraso",
                  data: [atrasados],
                  backgroundColor: "#f97316",
                  borderColor: "#f97316",
                  borderWidth: 1,
                },
              ],
            },
            options: {
              plugins: {
                legend: {
                  display: true,
                  position: "top",
                  labels: {
                    boxWidth: 20,
                    font: { size: 14 },
                  },
                },
              },
              responsive: true,
              scales: {
                y: { beginAtZero: true, ticks: { precision: 0 } },
              },
            },
          });
        });
      </script>
      <!-- Gráfico de colunas na horizontal -->
      <script>
        document.addEventListener("DOMContentLoaded", () => {
          const ctx2 = document.getElementById("grafico2").getContext("2d");

          const contagem = getContagemStatus();
          const ativos = contagem.ativo || 0;
          const inativos = contagem.inativo || 0;
          const atrasados = contagem.atraso || 0;

          new Chart(ctx2, {
            type: "bar",
            data: {
              labels: ["Clientes"],
              datasets: [
                {
                  label: "Ativos",
                  data: [ativos],
                  backgroundColor: "#16a34a",
                  borderColor: "#16a34a",
                  borderWidth: 1,
                },
                {
                  label: "Inativos",
                  data: [inativos],
                  backgroundColor: "#6b7280",
                  borderColor: "#6b7280",
                  borderWidth: 1,
                },
                {
                  label: "Em Atraso",
                  data: [atrasados],
                  backgroundColor: "#f97316",
                  borderColor: "#f97316",
                  borderWidth: 1,
                },
              ],
            },
            options: {
              indexAxis: "y", // ✅ faz o gráfico ficar deitado (horizontal)
              plugins: {
                legend: {
                  display: true,
                  position: "top", // legenda no topo (ou "left", se quiser)
                  labels: {
                    boxWidth: 20,
                    font: { size: 14 },
                  },
                },
              },
              responsive: true,
              scales: {
                x: {
                  beginAtZero: true,
                  ticks: { precision: 0 },
                },
                y: {
                  title: { display: false },
                },
              },
            },
          });
        });
      </script>
      <!-- Gráfico de linha -->
      <script>
        document.addEventListener("DOMContentLoaded", () => {
          const ctx = document.getElementById("grafico3").getContext("2d");

          const contagem = getContagemStatus();
          const ativos = contagem.ativo || 0;
          const inativos = contagem.inativo || 0;
          const atrasados = contagem.atraso || 0;

          new Chart(ctx, {
            type: "line",
            data: {
              labels: ["Clientes"],
              datasets: [
                {
                  label: "Ativos",
                  data: [ativos],
                  backgroundColor: "#16a34a",
                  borderColor: "#16a34a",
                  borderWidth: 1,
                },
                {
                  label: "Inativos",
                  data: [inativos],
                  backgroundColor: "#6b7280",
                  borderColor: "#6b7280",
                  borderWidth: 1,
                },
                {
                  label: "Em Atraso",
                  data: [atrasados],
                  backgroundColor: "#f97316",
                  borderColor: "#f97316",
                  borderWidth: 1,
                },
              ],
            },
            options: {
              plugins: {
                legend: {
                  display: true,
                  position: "top",
                  labels: {
                    boxWidth: 20,
                    font: { size: 14 },
                  },
                },
              },
              responsive: true,
              scales: {
                y: { beginAtZero: true, ticks: { precision: 0 } },
              },
            },
          });
        });
      </script>

      <script>
        document.addEventListener("DOMContentLoaded", () => {
          const ctx = document.getElementById("grafico4").getContext("2d");

          const contagem = getContagemStatus();
          const ativos = contagem.ativo || 0;
          const inativos = contagem.inativo || 0;
          const atrasados = contagem.atraso || 0;

          new Chart(ctx, {
            type: "doughnut",
            data: {
              labels: ["Ativos", "Inativos", "Em Atraso"],
              datasets: [
                {
                  data: [ativos, inativos, atrasados],
                  backgroundColor: ["#16a34a", "#6b7280", "#f97316"],
                  borderColor: "#fff",
                  borderWidth: 2,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  display: true,
                  position: "top",
                  labels: {
                    boxWidth: 20,
                    font: { size: 14 },
                  },
                },
                tooltip: {
                  callbacks: {
                    label: (context) => {
                      const total = context.chart.data.datasets[0].data.reduce(
                        (a, b) => a + b,
                        0
                      );
                      const valor = context.raw;
                      const porcentagem = ((valor / total) * 100).toFixed(1);
                      return `${context.label}: ${valor} (${porcentagem}%)`;
                    },
                  },
                },
              }, 
            },
          });
        });
      </script>
    </main>

    <script src="./src/JS/script.js"></script>
  </body>
</html>
